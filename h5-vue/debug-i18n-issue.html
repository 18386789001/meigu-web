<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug i18n Issue - Stocks Trading</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .debug-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .debug-title {
            color: #007bff;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        .debug-info {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 5px 0;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .translation-test {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 10px 0;
        }
        .key-column {
            background: #e9ecef;
            padding: 10px;
            border-radius: 4px;
        }
        .value-column {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” i18nè°ƒè¯•å·¥å…· - è‚¡ç¥¨äº¤æ˜“é¡µé¢</h1>
        
        <div class="debug-section">
            <div class="debug-title">ğŸ“Š å½“å‰çŠ¶æ€æ£€æŸ¥</div>
            <button class="test-button" onclick="checkCurrentStatus()">æ£€æŸ¥å½“å‰çŠ¶æ€</button>
            <div id="current-status"></div>
        </div>

        <div class="debug-section">
            <div class="debug-title">ğŸ”§ è¯­è¨€è®¾ç½®æµ‹è¯•</div>
            <button class="test-button" onclick="testLanguageSettings()">æµ‹è¯•è¯­è¨€è®¾ç½®</button>
            <button class="test-button" onclick="setLanguageToEn()">è®¾ç½®è¯­è¨€ä¸º 'en'</button>
            <button class="test-button" onclick="setLanguageToEnUS()">è®¾ç½®è¯­è¨€ä¸º 'en-US'</button>
            <div id="language-test-results"></div>
        </div>

        <div class="debug-section">
            <div class="debug-title">ğŸ“ ç¿»è¯‘é”®æµ‹è¯•</div>
            <button class="test-button" onclick="testStocksTranslations()">æµ‹è¯•è‚¡ç¥¨ç¿»è¯‘é”®</button>
            <div id="translation-test-results"></div>
        </div>

        <div class="debug-section">
            <div class="debug-title">ğŸŒ æµè§ˆå™¨ä¿¡æ¯</div>
            <div id="browser-info"></div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿè‹±æ–‡ç¿»è¯‘æ•°æ®
        const mockEnglishTranslations = {
            trading: {
                stocks: {
                    title: 'Stock Trading',
                    description: 'Global major stock market investment',
                    companies: 'Companies',
                    trading: 'Trading Hours',
                    commission: 'Commission',
                    hotStocks: 'Hot Stocks',
                    marketOpen: 'Market Open',
                    high: 'High',
                    low: 'Low',
                    volume: 'Volume',
                    chart: 'Chart',
                    trade: 'Trade',
                    advantages: 'Trading Advantages',
                    globalMarket: 'Global Market',
                    globalMarketDesc: 'Covering major global stock markets',
                    analysis: 'Professional Analysis',
                    analysisDesc: 'Professional market analysis tools',
                    fastExecution: 'Fast Execution',
                    fastExecutionDesc: 'Millisecond order execution',
                    lowCost: 'Low Cost',
                    lowCostDesc: 'Ultra-low commission rates',
                    realTime: 'Real-time Data',
                    realTimeDesc: 'Real-time market quotes',
                    professional: 'Professional Service',
                    professionalDesc: 'Professional investment advisors'
                }
            }
        };

        function checkCurrentStatus() {
            const results = [];
            
            // æ£€æŸ¥localStorage
            const storedLang = localStorage.getItem('lang');
            results.push(`localStorage['lang']: ${storedLang || 'null'}`);
            
            // æ£€æŸ¥æµè§ˆå™¨è¯­è¨€
            const browserLang = navigator.language || navigator.userLanguage;
            results.push(`æµè§ˆå™¨è¯­è¨€: ${browserLang}`);
            
            // æ£€æŸ¥URLå‚æ•°
            const urlParams = new URLSearchParams(window.location.search);
            const urlLang = urlParams.get('lang');
            results.push(`URLè¯­è¨€å‚æ•°: ${urlLang || 'null'}`);
            
            // æ£€æŸ¥å½“å‰é¡µé¢è¯­è¨€è®¾ç½®
            const htmlLang = document.documentElement.lang;
            results.push(`HTML langå±æ€§: ${htmlLang || 'null'}`);
            
            document.getElementById('current-status').innerHTML = 
                results.map(r => `<div class="debug-info">${r}</div>`).join('');
        }

        function testLanguageSettings() {
            const results = [];
            
            // æµ‹è¯•ä¸åŒè¯­è¨€ä»£ç çš„è®¾ç½®
            const testCodes = ['en', 'en-US', 'zh', 'zh-CN'];
            
            testCodes.forEach(code => {
                localStorage.setItem('lang', code);
                const retrieved = localStorage.getItem('lang');
                const status = retrieved === code ? 'success' : 'error';
                results.push(`<div class="debug-info ${status}">è®¾ç½® '${code}' -> è·å– '${retrieved}'</div>`);
            });
            
            document.getElementById('language-test-results').innerHTML = results.join('');
        }

        function setLanguageToEn() {
            localStorage.setItem('lang', 'en');
            alert('è¯­è¨€å·²è®¾ç½®ä¸º "en"ï¼Œè¯·åˆ·æ–°é¡µé¢æŸ¥çœ‹æ•ˆæœ');
        }

        function setLanguageToEnUS() {
            localStorage.setItem('lang', 'en-US');
            alert('è¯­è¨€å·²è®¾ç½®ä¸º "en-US"ï¼Œè¯·åˆ·æ–°é¡µé¢æŸ¥çœ‹æ•ˆæœ');
        }

        function testStocksTranslations() {
            const stocksKeys = [
                'trading.stocks.title',
                'trading.stocks.description',
                'trading.stocks.companies',
                'trading.stocks.trading',
                'trading.stocks.commission',
                'trading.stocks.lowCost',
                'trading.stocks.realTime',
                'trading.stocks.professional'
            ];

            let results = '<div class="translation-test">';
            results += '<div class="key-column"><strong>ç¿»è¯‘é”®</strong></div>';
            results += '<div class="value-column"><strong>æœŸæœ›å€¼</strong></div>';
            
            stocksKeys.forEach(key => {
                const expectedValue = getNestedValue(mockEnglishTranslations, key);
                const status = expectedValue ? 'success' : 'error';
                
                results += `<div class="key-column">${key}</div>`;
                results += `<div class="value-column ${status}">${expectedValue || 'æœªæ‰¾åˆ°'}</div>`;
            });
            
            results += '</div>';
            
            document.getElementById('translation-test-results').innerHTML = results;
        }

        function getNestedValue(obj, path) {
            return path.split('.').reduce((current, key) => {
                return current && current[key] !== undefined ? current[key] : null;
            }, obj);
        }

        function displayBrowserInfo() {
            const info = [
                `ç”¨æˆ·ä»£ç†: ${navigator.userAgent}`,
                `è¯­è¨€: ${navigator.language}`,
                `è¯­è¨€åˆ—è¡¨: ${navigator.languages ? navigator.languages.join(', ') : 'ä¸æ”¯æŒ'}`,
                `æ—¶åŒº: ${Intl.DateTimeFormat().resolvedOptions().timeZone}`,
                `å½“å‰URL: ${window.location.href}`,
                `Referrer: ${document.referrer || 'æ— '}`,
                `Cookieå¯ç”¨: ${navigator.cookieEnabled}`,
                `åœ¨çº¿çŠ¶æ€: ${navigator.onLine}`
            ];
            
            document.getElementById('browser-info').innerHTML = 
                info.map(i => `<div class="debug-info">${i}</div>`).join('');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œ
        window.onload = function() {
            checkCurrentStatus();
            displayBrowserInfo();
            
            // æ·»åŠ è¯­è¨€å˜æ›´ç›‘å¬
            window.addEventListener('storage', function(e) {
                if (e.key === 'lang') {
                    console.log('è¯­è¨€è®¾ç½®å·²å˜æ›´:', e.oldValue, '->', e.newValue);
                    checkCurrentStatus();
                }
            });
        };
    </script>
</body>
</html>
