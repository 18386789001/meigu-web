<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›½é™…åŒ–çŠ¶æ€è°ƒè¯•å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
            background: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        .status-info {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }
        .error {
            background: #ffebee;
            color: #c62828;
        }
        .success {
            background: #e8f5e8;
            color: #2e7d32;
        }
        .warning {
            background: #fff3e0;
            color: #ef6c00;
        }
        button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #1976d2;
        }
        .translation-test {
            background: #f9f9f9;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .key {
            font-weight: bold;
            color: #666;
        }
        .value {
            color: #333;
            margin-left: 10px;
        }
        .missing {
            color: red;
            font-weight: bold;
        }
        .found {
            color: green;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #f5f5f5;
        }
        .flag {
            font-size: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>å›½é™…åŒ–çŠ¶æ€è°ƒè¯•å·¥å…·</h1>
        
        <div class="test-section">
            <h3>å½“å‰çŠ¶æ€æ£€æŸ¥</h3>
            <button onclick="checkCurrentStatus()">æ£€æŸ¥å½“å‰çŠ¶æ€</button>
            <button onclick="checkLocalStorage()">æ£€æŸ¥LocalStorage</button>
            <button onclick="testTranslations()">æµ‹è¯•ç¿»è¯‘</button>
            <button onclick="simulateLanguageSwitch()">æ¨¡æ‹Ÿè¯­è¨€åˆ‡æ¢</button>
            <div id="statusInfo" class="status-info"></div>
        </div>
        
        <div class="test-section">
            <h3>è¯­è¨€é…ç½®æ£€æŸ¥</h3>
            <div id="languageConfig"></div>
        </div>
        
        <div class="test-section">
            <h3>ç¿»è¯‘é”®å€¼æ£€æŸ¥</h3>
            <div id="translationCheck"></div>
        </div>
        
        <div class="test-section">
            <h3>æ¨¡æ‹Ÿè¯­è¨€åˆ‡æ¢</h3>
            <div id="languageSwitcher"></div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿè¯­è¨€é…ç½®
        const languages = [
            { code: 'zh-CN', name: 'ç®€ä½“ä¸­æ–‡', flag: 'ğŸ‡¨ğŸ‡³' },
            { code: 'zh-TW', name: 'ç¹é«”ä¸­æ–‡', flag: 'ğŸ‡¹ğŸ‡¼' },
            { code: 'en-US', name: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
            { code: 'ja-JP', name: 'æ—¥æœ¬èª', flag: 'ğŸ‡¯ğŸ‡µ' },
            { code: 'ko-KR', name: 'í•œêµ­ì–´', flag: 'ğŸ‡°ğŸ‡·' },
            { code: 'th-TH', name: 'à¹„à¸—à¸¢', flag: 'ğŸ‡¹ğŸ‡­' }
        ];

        // æ¨¡æ‹Ÿç¿»è¯‘æ•°æ®
        const translations = {
            'zh-CN': {
                'trading.forex.title': 'å¤–æ±‡äº¤æ˜“',
                'trading.forex.description': 'å…¨çƒä¸»è¦è´§å¸å¯¹äº¤æ˜“',
                'trading.forex.chart': 'å›¾è¡¨',
                'trading.forex.trade': 'äº¤æ˜“',
                'trading.forex.high': 'æœ€é«˜',
                'trading.forex.low': 'æœ€ä½',
                'trading.forex.advantages': 'äº¤æ˜“ä¼˜åŠ¿'
            },
            'en-US': {
                'trading.forex.title': 'Forex Trading',
                'trading.forex.description': 'Global major currency pair trading',
                'trading.forex.chart': 'Chart',
                'trading.forex.trade': 'Trade',
                'trading.forex.high': 'High',
                'trading.forex.low': 'Low',
                'trading.forex.advantages': 'Trading Advantages'
            },
            'ja-JP': {
                'trading.forex.title': 'FXå–å¼•',
                'trading.forex.description': 'ã‚°ãƒ­ãƒ¼ãƒãƒ«ä¸»è¦é€šè²¨ãƒšã‚¢å–å¼•',
                'trading.forex.chart': 'ãƒãƒ£ãƒ¼ãƒˆ',
                'trading.forex.trade': 'å–å¼•',
                'trading.forex.high': 'é«˜å€¤',
                'trading.forex.low': 'å®‰å€¤',
                'trading.forex.advantages': 'å–å¼•ãƒ¡ãƒªãƒƒãƒˆ'
            }
        };

        function getCurrentLanguage() {
            return localStorage.getItem('lang') || 'zh-CN';
        }

        function checkCurrentStatus() {
            const currentLang = getCurrentLanguage();
            const timestamp = new Date().toLocaleString();
            const userAgent = navigator.userAgent;
            
            document.getElementById('statusInfo').innerHTML = `
                <div class="success">
                    <strong>å½“å‰çŠ¶æ€ï¼š</strong><br>
                    æ—¶é—´: ${timestamp}<br>
                    å½“å‰è¯­è¨€: ${currentLang}<br>
                    é¡µé¢URL: ${window.location.href}<br>
                    UserAgent: ${userAgent.substring(0, 100)}...
                </div>
            `;
        }

        function checkLocalStorage() {
            const lang = localStorage.getItem('lang');
            const allKeys = Object.keys(localStorage);
            
            let statusClass = 'success';
            let statusText = 'LocalStorageçŠ¶æ€æ­£å¸¸';
            
            if (!lang) {
                statusClass = 'warning';
                statusText = 'LocalStorageä¸­æ²¡æœ‰è¯­è¨€è®¾ç½®';
            } else if (!translations[lang]) {
                statusClass = 'error';
                statusText = `è¯­è¨€ä»£ç  ${lang} ä¸è¢«æ”¯æŒ`;
            }
            
            document.getElementById('statusInfo').innerHTML = `
                <div class="${statusClass}">
                    <strong>LocalStorageæ£€æŸ¥ï¼š</strong><br>
                    ${statusText}<br>
                    è¯­è¨€è®¾ç½®: ${lang || 'æœªè®¾ç½®'}<br>
                    æ‰€æœ‰é”®: ${allKeys.join(', ')}
                </div>
            `;
        }

        function testTranslations() {
            const currentLang = getCurrentLanguage();
            const langTranslations = translations[currentLang] || {};
            
            const testKeys = [
                'trading.forex.title',
                'trading.forex.description', 
                'trading.forex.chart',
                'trading.forex.trade',
                'trading.forex.high',
                'trading.forex.low',
                'trading.forex.advantages'
            ];
            
            let html = `<h4>ç¿»è¯‘æµ‹è¯•ç»“æœ (${currentLang}):</h4>`;
            
            testKeys.forEach(key => {
                const translation = langTranslations[key];
                const hasTranslation = translation && translation !== key;
                const statusClass = hasTranslation ? 'found' : 'missing';
                const statusText = hasTranslation ? 'âœ“' : 'âœ—';
                
                html += `
                    <div class="translation-test">
                        <span class="key">${key}:</span>
                        <span class="value ${statusClass}">${translation || key}</span>
                        <span class="${statusClass}">${statusText}</span>
                    </div>
                `;
            });
            
            document.getElementById('translationCheck').innerHTML = html;
        }

        function simulateLanguageSwitch() {
            let html = '<h4>è¯­è¨€åˆ‡æ¢æµ‹è¯•ï¼š</h4>';
            
            languages.forEach(lang => {
                html += `
                    <button onclick="switchToLanguage('${lang.code}')">
                        <span class="flag">${lang.flag}</span> ${lang.name}
                    </button>
                `;
            });
            
            document.getElementById('languageSwitcher').innerHTML = html;
        }

        function switchToLanguage(langCode) {
            console.log('åˆ‡æ¢åˆ°è¯­è¨€:', langCode);
            localStorage.setItem('lang', langCode);
            
            // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
            window.dispatchEvent(new CustomEvent('language-changed', { 
                detail: { locale: langCode } 
            }));
            
            // æ›´æ–°æ˜¾ç¤º
            testTranslations();
            checkCurrentStatus();
            checkLocalStorage();
            
            alert(`å·²åˆ‡æ¢åˆ° ${languages.find(l => l.code === langCode)?.name || langCode}`);
        }

        function displayLanguageConfig() {
            let html = '<h4>æ”¯æŒçš„è¯­è¨€ï¼š</h4>';
            html += '<table>';
            html += '<tr><th>ä»£ç </th><th>åç§°</th><th>æ ‡å¿—</th><th>ç¿»è¯‘çŠ¶æ€</th></tr>';
            
            languages.forEach(lang => {
                const hasTranslations = translations[lang.code] ? 'âœ“' : 'âœ—';
                const statusClass = translations[lang.code] ? 'success' : 'error';
                
                html += `
                    <tr>
                        <td>${lang.code}</td>
                        <td>${lang.name}</td>
                        <td><span class="flag">${lang.flag}</span></td>
                        <td class="${statusClass}">${hasTranslations}</td>
                    </tr>
                `;
            });
            
            html += '</table>';
            document.getElementById('languageConfig').innerHTML = html;
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = function() {
            checkCurrentStatus();
            checkLocalStorage();
            testTranslations();
            displayLanguageConfig();
            simulateLanguageSwitch();
            
            // ç›‘å¬è¯­è¨€åˆ‡æ¢äº‹ä»¶
            window.addEventListener('language-changed', function(event) {
                console.log('æ£€æµ‹åˆ°è¯­è¨€åˆ‡æ¢äº‹ä»¶:', event.detail);
                testTranslations();
                checkCurrentStatus();
            });
        };
    </script>
</body>
</html>
