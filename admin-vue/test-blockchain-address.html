<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¬å…±åœ°å€ç®¡ç†åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .info {
            background-color: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }
        .code {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 3px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            margin: 10px 0;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .test-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ å…¬å…±åœ°å€ç®¡ç†åŠŸèƒ½æµ‹è¯•é¡µé¢</h1>
    
    <div class="test-section info">
        <h3>ğŸ“‹ é—®é¢˜ä¿®å¤è¯´æ˜</h3>
        <p><strong>æ ¹æœ¬åŸå› </strong>ï¼šåç«¯å®ä½“ç±»ä½¿ç”¨ <code>uuid</code> ä½œä¸ºä¸»é”®ï¼Œå‰ç«¯å´ä½¿ç”¨ <code>id</code> å­—æ®µ</p>
        <p><strong>ä¿®å¤æ–¹æ¡ˆ</strong>ï¼šå‰ç«¯æ”¹ä¸ºä½¿ç”¨ <code>uuid</code> å­—æ®µï¼Œå¹¶ä¼˜åŒ–å¼¹çª—æ ‡é¢˜åˆ¤æ–­é€»è¾‘</p>
    </div>

    <div class="test-section">
        <h3>ğŸ§ª æµ‹è¯•1ï¼šIDå­—æ®µæ˜ å°„æµ‹è¯•</h3>
        <p>æ¨¡æ‹Ÿåç«¯è¿”å›çš„æ•°æ®ç»“æ„ï¼Œæµ‹è¯•IDå­—æ®µçš„æ­£ç¡®è¯†åˆ«</p>
        <button onclick="testIdMapping()">è¿è¡Œæµ‹è¯•</button>
        <div id="test1-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ§ª æµ‹è¯•2ï¼šå¼¹çª—æ ‡é¢˜åˆ¤æ–­æµ‹è¯•</h3>
        <p>æµ‹è¯•ä¸åŒIDå€¼ä¸‹çš„å¼¹çª—æ ‡é¢˜æ˜¾ç¤ºé€»è¾‘</p>
        <button onclick="testDialogTitle()">è¿è¡Œæµ‹è¯•</button>
        <div id="test2-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ§ª æµ‹è¯•3ï¼šIDæœ‰æ•ˆæ€§åˆ¤æ–­æµ‹è¯•</h3>
        <p>æµ‹è¯•å„ç§è¾¹ç•Œæƒ…å†µä¸‹çš„IDæœ‰æ•ˆæ€§åˆ¤æ–­</p>
        <button onclick="testIdValidation()">è¿è¡Œæµ‹è¯•</button>
        <div id="test3-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ§ª æµ‹è¯•4ï¼šAPIæ¥å£æ•°æ®æ ¼å¼æµ‹è¯•</h3>
        <p>æµ‹è¯•æ–°å¢å’Œä¿®æ”¹æ—¶çš„è¯·æ±‚æ•°æ®æ ¼å¼</p>
        <button onclick="testApiDataFormat()">è¿è¡Œæµ‹è¯•</button>
        <div id="test4-result" class="test-result"></div>
    </div>

    <div class="test-section success">
        <h3>âœ… éªŒè¯æ¸…å•</h3>
        <ul>
            <li>âœ… ç¼–è¾‘æŒ‰é’®ä½¿ç”¨ <code>row.uuid</code> è€Œä¸æ˜¯ <code>row.id</code></li>
            <li>âœ… å¼¹çª—æ ‡é¢˜æ ¹æ® <code>isUpdate</code> çŠ¶æ€åŠ¨æ€æ˜¾ç¤º</li>
            <li>âœ… IDæœ‰æ•ˆæ€§åˆ¤æ–­æ”¯æŒUUIDå­—ç¬¦ä¸²å’Œæ•°å­—ID</li>
            <li>âœ… æ–°å¢æ¥å£ï¼š<code>/channelBlockchain/save</code></li>
            <li>âœ… ä¿®æ”¹æ¥å£ï¼š<code>/channelBlockchain/update</code></li>
            <li>âœ… è·å–è¯¦æƒ…æ¥å£ï¼š<code>/channelBlockchain/info/{uuid}</code></li>
        </ul>
    </div>

    <script>
        // æ¨¡æ‹Ÿåç«¯è¿”å›çš„æ•°æ®ç»“æ„
        const mockRowData = {
            uuid: "1234567890abcdef",
            id: undefined, // åç«¯ä¸è¿”å›idå­—æ®µ
            blockchainName: "TRC20",
            address: "TX1bf7H5NhZu4tcU9oiNQE",
            status: 1,
            remark: "æµ‹è¯•åœ°å€",
            createTime: "2024-01-01 12:00:00"
        };

        // æ¨¡æ‹ŸIDæœ‰æ•ˆæ€§åˆ¤æ–­å‡½æ•°
        function isValidId(id) {
            if (id === null || id === undefined || id === '' || id === 'null' || id === 'undefined') {
                return false;
            }
            
            if (id === 0 || id === '0') {
                return false;
            }
            
            if (typeof id === 'string') {
                const num = Number(id);
                return !isNaN(num) && num > 0;
            }
            
            if (typeof id === 'number') {
                return id > 0;
            }
            
            return true;
        }

        // æ¨¡æ‹Ÿå¼¹çª—æ ‡é¢˜è®¡ç®—
        function getDialogTitle(isUpdate) {
            return isUpdate ? 'ä¿®æ”¹åœ°å€' : 'æ–°å¢åœ°å€';
        }

        // æµ‹è¯•1ï¼šIDå­—æ®µæ˜ å°„
        function testIdMapping() {
            const resultDiv = document.getElementById('test1-result');
            let html = '<div class="code">';
            
            html += 'æ¨¡æ‹Ÿæ•°æ®ç»“æ„:\n';
            html += JSON.stringify(mockRowData, null, 2) + '\n\n';
            
            // æµ‹è¯•IDæå–é€»è¾‘
            const actualId = mockRowData.uuid || mockRowData.id;
            html += `IDæå–ç»“æœ:\n`;
            html += `row.uuid: ${mockRowData.uuid} (${typeof mockRowData.uuid})\n`;
            html += `row.id: ${mockRowData.id} (${typeof mockRowData.id})\n`;
            html += `æœ€ç»ˆID: ${actualId} (${typeof actualId})\n`;
            
            html += '</div>';
            
            if (actualId === "1234567890abcdef") {
                html += '<div class="test-result success">âœ… æµ‹è¯•é€šè¿‡ï¼šæ­£ç¡®æå–åˆ°UUIDå­—æ®µ</div>';
            } else {
                html += '<div class="test-result error">âŒ æµ‹è¯•å¤±è´¥ï¼šæœªèƒ½æ­£ç¡®æå–UUIDå­—æ®µ</div>';
            }
            
            resultDiv.innerHTML = html;
        }

        // æµ‹è¯•2ï¼šå¼¹çª—æ ‡é¢˜åˆ¤æ–­
        function testDialogTitle() {
            const resultDiv = document.getElementById('test2-result');
            let html = '<div class="code">';
            
            const testCases = [
                { id: "1234567890abcdef", expected: "ä¿®æ”¹åœ°å€" },
                { id: null, expected: "æ–°å¢åœ°å€" },
                { id: undefined, expected: "æ–°å¢åœ°å€" },
                { id: "", expected: "æ–°å¢åœ°å€" },
                { id: 0, expected: "æ–°å¢åœ°å€" },
                { id: "0", expected: "æ–°å¢åœ°å€" },
                { id: 123, expected: "ä¿®æ”¹åœ°å€" }
            ];
            
            let allPassed = true;
            
            testCases.forEach(testCase => {
                const isUpdate = isValidId(testCase.id);
                const title = getDialogTitle(isUpdate);
                const passed = title === testCase.expected;
                
                html += `ID: ${JSON.stringify(testCase.id)} â†’ isUpdate: ${isUpdate} â†’ æ ‡é¢˜: "${title}" `;
                html += passed ? 'âœ…\n' : `âŒ (æœŸæœ›: "${testCase.expected}")\n`;
                
                if (!passed) allPassed = false;
            });
            
            html += '</div>';
            
            if (allPassed) {
                html += '<div class="test-result success">âœ… æµ‹è¯•é€šè¿‡ï¼šæ‰€æœ‰å¼¹çª—æ ‡é¢˜åˆ¤æ–­æ­£ç¡®</div>';
            } else {
                html += '<div class="test-result error">âŒ æµ‹è¯•å¤±è´¥ï¼šéƒ¨åˆ†å¼¹çª—æ ‡é¢˜åˆ¤æ–­é”™è¯¯</div>';
            }
            
            resultDiv.innerHTML = html;
        }

        // æµ‹è¯•3ï¼šIDæœ‰æ•ˆæ€§åˆ¤æ–­
        function testIdValidation() {
            const resultDiv = document.getElementById('test3-result');
            let html = '<div class="code">';
            
            const testCases = [
                { id: "1234567890abcdef", expected: true },
                { id: "123", expected: true },
                { id: 123, expected: true },
                { id: null, expected: false },
                { id: undefined, expected: false },
                { id: "", expected: false },
                { id: "null", expected: false },
                { id: "undefined", expected: false },
                { id: 0, expected: false },
                { id: "0", expected: false },
                { id: -1, expected: false }
            ];
            
            let allPassed = true;
            
            testCases.forEach(testCase => {
                const result = isValidId(testCase.id);
                const passed = result === testCase.expected;
                
                html += `isValidId(${JSON.stringify(testCase.id)}) â†’ ${result} `;
                html += passed ? 'âœ…\n' : `âŒ (æœŸæœ›: ${testCase.expected})\n`;
                
                if (!passed) allPassed = false;
            });
            
            html += '</div>';
            
            if (allPassed) {
                html += '<div class="test-result success">âœ… æµ‹è¯•é€šè¿‡ï¼šæ‰€æœ‰IDæœ‰æ•ˆæ€§åˆ¤æ–­æ­£ç¡®</div>';
            } else {
                html += '<div class="test-result error">âŒ æµ‹è¯•å¤±è´¥ï¼šéƒ¨åˆ†IDæœ‰æ•ˆæ€§åˆ¤æ–­é”™è¯¯</div>';
            }
            
            resultDiv.innerHTML = html;
        }

        // æµ‹è¯•4ï¼šAPIæ¥å£æ•°æ®æ ¼å¼
        function testApiDataFormat() {
            const resultDiv = document.getElementById('test4-result');
            let html = '<div class="code">';
            
            // æ–°å¢æ•°æ®æ ¼å¼
            const addData = {
                blockchainName: "TRC20",
                address: "TX1bf7H5NhZu4tcU9oiNQE",
                status: 1,
                remark: "æ–°å¢åœ°å€"
            };
            
            // ä¿®æ”¹æ•°æ®æ ¼å¼
            const updateData = {
                id: "1234567890abcdef",
                blockchainName: "TRC20-Updated",
                address: "TX1bf7H5NhZu4tcU9oiNQE-Updated",
                status: 1,
                remark: "ä¿®æ”¹åçš„åœ°å€"
            };
            
            html += 'æ–°å¢æ¥å£æ•°æ®æ ¼å¼ (POST /channelBlockchain/save):\n';
            html += JSON.stringify(addData, null, 2) + '\n\n';
            
            html += 'ä¿®æ”¹æ¥å£æ•°æ®æ ¼å¼ (POST /channelBlockchain/update):\n';
            html += JSON.stringify(updateData, null, 2) + '\n\n';
            
            html += 'è·å–è¯¦æƒ…æ¥å£ (GET /channelBlockchain/info/{uuid}):\n';
            html += 'GET /channelBlockchain/info/1234567890abcdef\n';
            
            html += '</div>';
            html += '<div class="test-result success">âœ… APIæ¥å£æ•°æ®æ ¼å¼æ­£ç¡®</div>';
            
            resultDiv.innerHTML = html;
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•
        window.onload = function() {
            console.log('ğŸ§ª å¼€å§‹è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•...');
            setTimeout(() => {
                testIdMapping();
                setTimeout(() => testDialogTitle(), 500);
                setTimeout(() => testIdValidation(), 1000);
                setTimeout(() => testApiDataFormat(), 1500);
            }, 1000);
        };
    </script>
</body>
</html>
