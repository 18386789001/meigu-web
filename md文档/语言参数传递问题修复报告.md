# è¯­è¨€å‚æ•°ä¼ é€’é—®é¢˜ä¿®å¤æŠ¥å‘Š

## ğŸ› é—®é¢˜æè¿°

ç”¨æˆ·åé¦ˆï¼šåœ¨ H5-Vue é¡µé¢é€‰æ‹©è¯­è¨€åï¼Œç‚¹å‡»"ç™»å½•"æˆ–"æ³¨å†Œ"æŒ‰é’®è·³è½¬åˆ° WAP-Vue æ—¶ï¼ŒURL ä¸­æ²¡æœ‰æºå¸¦è¯­è¨€å‚æ•°ã€‚

## ğŸ” é—®é¢˜åŸå› 

åŸå§‹çš„ `generateUrl()` å‡½æ•°åœ¨å¤„ç†å¸¦ hash è·¯ç”±çš„ URL æ—¶ï¼Œå°†æŸ¥è¯¢å‚æ•°æ”¾åœ¨äº† hash ä¹‹åï¼Œå¯¼è‡´å‚æ•°æ— æ³•è¢«æ­£ç¡®è§£æï¼š

### âŒ é”™è¯¯çš„URLæ ¼å¼
```
https://jpmx.xyz/syn/#/my/index?lang=Japanese
                        â†‘                â†‘
                      hash          æŸ¥è¯¢å‚æ•°ï¼ˆé”™è¯¯ä½ç½®ï¼‰
```

åœ¨è¿™ç§æ ¼å¼ä¸‹ï¼Œ`?lang=Japanese` è¢«è§†ä¸º hash è·¯ç”±çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æŸ¥è¯¢å‚æ•°ã€‚

### âœ… æ­£ç¡®çš„URLæ ¼å¼
```
https://jpmx.xyz/syn/?lang=Japanese#/my/index
                        â†‘                â†‘
                   æŸ¥è¯¢å‚æ•°ï¼ˆæ­£ç¡®ï¼‰      hash
```

æŸ¥è¯¢å‚æ•°åº”è¯¥åœ¨ hash ä¹‹å‰ï¼Œè¿™æ ·æ‰èƒ½è¢«æ­£ç¡®è§£æã€‚

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### 1. ä¿®æ”¹ `generateUrl()` å‡½æ•°

**æ–‡ä»¶**: `h5-vue/src/utils/domainManager.js`

**ä¿®æ”¹å†…å®¹**:
```javascript
// ç”Ÿæˆå®Œæ•´URL
const generateUrl = (path = '', params = {}, options = {}) => {
  // ... å‰é¢çš„ä»£ç  ...
  
  // æ£€æŸ¥è·¯å¾„ä¸­æ˜¯å¦åŒ…å«hash (#)
  let hashPart = '';
  let pathPart = path;
  if (path.includes('#')) {
    const hashIndex = path.indexOf('#');
    pathPart = path.substring(0, hashIndex);
    hashPart = path.substring(hashIndex);
  }
  
  let fullUrl = baseUrl + pathPart;

  // æ·»åŠ æŸ¥è¯¢å‚æ•°ï¼ˆåœ¨hashä¹‹å‰ï¼‰
  if (Object.keys(params).length > 0) {
    const searchParams = new URLSearchParams();
    Object.entries(params).forEach(([key, value]) => {
      if (value !== null && value !== undefined) {
        searchParams.append(key, value);
      }
    });
    const queryString = searchParams.toString();
    if (queryString) {
      fullUrl += (fullUrl.includes('?') ? '&' : '?') + queryString;
    }
  }

  // æ·»åŠ hashéƒ¨åˆ†
  fullUrl += hashPart;

  return fullUrl;
};
```

**å…³é”®æ”¹è¿›**ï¼š
1. æ£€æµ‹è·¯å¾„ä¸­æ˜¯å¦åŒ…å« hash (`#`)
2. å°†è·¯å¾„åˆ†ç¦»ä¸º pathPart å’Œ hashPart
3. å…ˆæ·»åŠ æŸ¥è¯¢å‚æ•°åˆ° pathPart
4. æœ€åæ‹¼æ¥ hashPart

### 2. æ·»åŠ è°ƒè¯•æ—¥å¿—

**æ–‡ä»¶**: `h5-vue/src/App.vue`

åœ¨ `goToLogin()` å’Œ `goToRegister()` æ–¹æ³•ä¸­æ·»åŠ è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼š

```javascript
// è·³è½¬åˆ°ç™»å½•é¡µï¼ˆæºå¸¦è¯­è¨€å‚æ•°ï¼‰
const goToLogin = () => {
  const langCode = getWapLanguageCode(currentLanguageCode.value)
  const loginUrl = config.URLS.LOGIN({ lang: langCode })
  console.log('ğŸ”— è·³è½¬åˆ°ç™»å½•é¡µ')
  console.log('ğŸ“ å½“å‰è¯­è¨€ä»£ç  (H5):', currentLanguageCode.value)
  console.log('ğŸ“ è½¬æ¢åè¯­è¨€ä»£ç  (WAP):', langCode)
  console.log('ğŸŒ ç”Ÿæˆçš„ç™»å½•URL:', loginUrl)
  window.location.href = loginUrl
  closeSidebar()
}
```

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### æ–¹æ³• 1ï¼šä½¿ç”¨æµ‹è¯•å·¥å…·é¡µé¢

æˆ‘å·²åˆ›å»ºäº†ä¸€ä¸ªç‹¬ç«‹çš„æµ‹è¯•å·¥å…·ï¼š`h5-vue/test-url-generation.html`

**åŠŸèƒ½**ï¼š
- æµ‹è¯•åŸºç¡€ URL ç”Ÿæˆ
- æµ‹è¯•å¸¦è¯­è¨€å‚æ•°çš„ URL
- éªŒè¯ hash ä½ç½®
- æµ‹è¯•æ‰€æœ‰æ”¯æŒçš„è¯­è¨€

**ä½¿ç”¨æ–¹å¼**ï¼š
1. åœ¨æµè§ˆå™¨ä¸­ç›´æ¥æ‰“å¼€è¯¥æ–‡ä»¶
2. ç‚¹å‡»å„ä¸ªæµ‹è¯•æŒ‰é’®
3. æŸ¥çœ‹ç”Ÿæˆçš„ URL æ˜¯å¦æ­£ç¡®

### æ–¹æ³• 2ï¼šåœ¨å®é™…é¡¹ç›®ä¸­æµ‹è¯•

#### æ­¥éª¤ 1ï¼šå¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
cd D:\Awww\mt5new\template\h5-vue
yarn dev
```

#### æ­¥éª¤ 2ï¼šæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
æŒ‰ `F12` æ‰“å¼€ Console æ ‡ç­¾é¡µ

#### æ­¥éª¤ 3ï¼šé€‰æ‹©è¯­è¨€å¹¶ç‚¹å‡»ç™»å½•
1. è®¿é—® http://localhost:5173
2. ç‚¹å‡»å³ä¸Šè§’è¯­è¨€é€‰æ‹©å™¨ï¼Œé€‰æ‹©"æ—¥æœ¬èª"
3. ç‚¹å‡»æ±‰å ¡èœå•ï¼ˆâ˜°ï¼‰
4. ç‚¹å‡»"ç™»å½•"æŒ‰é’®

#### æ­¥éª¤ 4ï¼šæŸ¥çœ‹æ§åˆ¶å°è¾“å‡º
åº”è¯¥çœ‹åˆ°ï¼š
```
ğŸ”— è·³è½¬åˆ°ç™»å½•é¡µ
ğŸ“ å½“å‰è¯­è¨€ä»£ç  (H5): ja-JP
ğŸ“ è½¬æ¢åè¯­è¨€ä»£ç  (WAP): Japanese
ğŸŒ ç”Ÿæˆçš„ç™»å½•URL: https://jpmx.xyz/syn/?lang=Japanese#/my/index
```

## âœ… éªŒè¯æ¸…å•

æµ‹è¯•ä»¥ä¸‹æ‰€æœ‰åœºæ™¯ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸ï¼š

- [ ] **è‹±è¯­** - URLåº”ä¸º: `?lang=en#/my/index`
- [ ] **æ—¥è¯­** - URLåº”ä¸º: `?lang=Japanese#/my/index`
- [ ] **éŸ©è¯­** - URLåº”ä¸º: `?lang=Korean#/my/index`
- [ ] **æ³°è¯­** - URLåº”ä¸º: `?lang=th#/my/index`
- [ ] **è¶Šå—è¯­** - URLåº”ä¸º: `?lang=vi#/my/index`
- [ ] **å¾·è¯­** - URLåº”ä¸º: `?lang=de#/my/index`
- [ ] **è¥¿ç­ç‰™è¯­** - URLåº”ä¸º: `?lang=es#/my/index`
- [ ] **æ³•è¯­** - URLåº”ä¸º: `?lang=fr#/my/index`
- [ ] **æ„å¤§åˆ©è¯­** - URLåº”ä¸º: `?lang=Italy#/my/index`
- [ ] **è‘¡è„ç‰™è¯­** - URLåº”ä¸º: `?lang=pt#/my/index`
- [ ] **å¸Œè…Šè¯­** - URLåº”ä¸º: `?lang=gr#/my/index`
- [ ] **ä¸­æ–‡** - URLåº”ä¸º: `?lang=CN#/my/index`

### éªŒè¯è¦ç‚¹

å¯¹æ¯ä¸ªURLï¼Œæ£€æŸ¥ï¼š
1. âœ… æŸ¥è¯¢å‚æ•° `?lang=xxx` å‡ºç°åœ¨ hash `#` **ä¹‹å‰**
2. âœ… URLæ ¼å¼ä¸ºï¼š`åè®®://åŸŸå/è·¯å¾„?å‚æ•°#hash`
3. âœ… å®é™…è·³è½¬åˆ°è¯¥URL
4. âœ… WAP-Vueé¡µé¢æ˜¾ç¤ºå¯¹åº”è¯­è¨€

## ğŸ“Š ä¿®å¤å¯¹æ¯”

### ä¿®å¤å‰
```javascript
// åŸå§‹ä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰
const generateUrl = (path, params) => {
  let fullUrl = baseUrl + path;
  if (params) {
    fullUrl += '?' + queryString;
  }
  return fullUrl;
}

// ç»“æœï¼ˆé”™è¯¯ï¼‰
generateUrl('/syn/#/my/index', { lang: 'Japanese' })
// => 'https://jpmx.xyz/syn/#/my/index?lang=Japanese' âŒ
```

### ä¿®å¤å
```javascript
// æ–°ä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰
const generateUrl = (path, params) => {
  let hashPart = '';
  let pathPart = path;
  
  if (path.includes('#')) {
    [pathPart, hashPart] = path.split('#');
    hashPart = '#' + hashPart;
  }
  
  let fullUrl = baseUrl + pathPart;
  
  if (params) {
    fullUrl += '?' + queryString;
  }
  
  fullUrl += hashPart;
  return fullUrl;
}

// ç»“æœï¼ˆæ­£ç¡®ï¼‰
generateUrl('/syn/#/my/index', { lang: 'Japanese' })
// => 'https://jpmx.xyz/syn/?lang=Japanese#/my/index' âœ…
```

## ğŸ“ ç›¸å…³æ–‡æ¡£

å·²åˆ›å»ºä»¥ä¸‹æ–‡æ¡£å¸®åŠ©æµ‹è¯•å’Œè°ƒè¯•ï¼š

1. **è¯­è¨€å‚æ•°ä¼ é€’è°ƒè¯•æŒ‡å—.md** - è¯¦ç»†çš„è°ƒè¯•æ­¥éª¤å’Œé—®é¢˜æ’æŸ¥
2. **test-url-generation.html** - ç‹¬ç«‹çš„URLç”Ÿæˆæµ‹è¯•å·¥å…·
3. **è¯­è¨€å‚æ•°ä¼ é€’åŠŸèƒ½è¯´æ˜.md** - åŸå§‹åŠŸèƒ½è¯´æ˜æ–‡æ¡£
4. **è¯­è¨€å‚æ•°ä¼ é€’æµ‹è¯•æŒ‡å—.html** - å¯è§†åŒ–æµ‹è¯•æŒ‡å—

## ğŸ¯ é¢„æœŸè¡Œä¸º

### ç”¨æˆ·æ“ä½œæµç¨‹
1. ç”¨æˆ·åœ¨ H5-Vue é¡µé¢é€‰æ‹©è¯­è¨€ï¼ˆä¾‹å¦‚ï¼šæ—¥è¯­ï¼‰
2. ç‚¹å‡»"ç™»å½•"æˆ–"æ³¨å†Œ"æŒ‰é’®
3. è‡ªåŠ¨è·³è½¬åˆ° WAP-Vueï¼ŒURLæ ¼å¼ï¼š
   ```
   https://jpmx.xyz/syn/?lang=Japanese#/my/index
   ```
4. WAP-Vue è¯»å– URL å‚æ•° `lang=Japanese`
5. è‡ªåŠ¨å°†é¡µé¢è¯­è¨€è®¾ç½®ä¸ºæ—¥è¯­
6. ç”¨æˆ·çœ‹åˆ°æ—¥è¯­ç•Œé¢çš„ç™»å½•/æ³¨å†Œé¡µé¢

### æŠ€æœ¯å®ç°æµç¨‹
```
H5-Vue
  â†“ ç”¨æˆ·é€‰æ‹©æ—¥è¯­
currentLanguageCode.value = 'ja-JP'
  â†“
getWapLanguageCode('ja-JP') â†’ 'Japanese'
  â†“
config.URLS.LOGIN({ lang: 'Japanese' })
  â†“
generateWapUrl('/#/my/index', { lang: 'Japanese' })
  â†“
generateUrl('/syn/#/my/index', { lang: 'Japanese' })
  â†“
åˆ†ç¦»: pathPart='/syn/', hashPart='#/my/index'
  â†“
æ‹¼æ¥: '/syn/' + '?lang=Japanese' + '#/my/index'
  â†“
ç»“æœ: 'https://jpmx.xyz/syn/?lang=Japanese#/my/index' âœ…
  â†“
WAP-Vue
  â†“
getLanguageFromUrl() â†’ 'Japanese'
  â†“
localStorage.setItem('lang', 'Japanese')
  â†“
i18nåˆ‡æ¢åˆ°æ—¥è¯­
  â†“
é¡µé¢æ˜¾ç¤ºæ—¥è¯­ç•Œé¢ âœ…
```

## ğŸ”„ åç»­æ­¥éª¤

### ç«‹å³æ‰§è¡Œ
1. âœ… å¯åŠ¨ H5-Vue å¼€å‘æœåŠ¡å™¨
2. âœ… æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
3. âœ… é€‰æ‹©ä»»æ„è¯­è¨€
4. âœ… ç‚¹å‡»ç™»å½•/æ³¨å†Œ
5. âœ… æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
6. âœ… éªŒè¯ç”Ÿæˆçš„ URL æ ¼å¼

### å¦‚æœè¿˜æœ‰é—®é¢˜
1. æŸ¥çœ‹ `è¯­è¨€å‚æ•°ä¼ é€’è°ƒè¯•æŒ‡å—.md`
2. ä½¿ç”¨ `test-url-generation.html` æµ‹è¯•å·¥å…·
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°çš„å®Œæ•´æ—¥å¿—
4. ç¡®è®¤æ‰€æœ‰æ–‡ä»¶å·²ä¿å­˜å¹¶é‡å¯å¼€å‘æœåŠ¡å™¨

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚æœæŒ‰ç…§ä¸Šè¿°æ­¥éª¤æµ‹è¯•åä»ç„¶å­˜åœ¨é—®é¢˜ï¼Œè¯·æä¾›ï¼š

1. **æµè§ˆå™¨æ§åˆ¶å°çš„å®Œæ•´æˆªå›¾**
2. **ç‚¹å‡»ç™»å½•åå®é™…è·³è½¬çš„å®Œæ•´URL**
3. **ä½¿ç”¨çš„æµè§ˆå™¨åç§°å’Œç‰ˆæœ¬**
4. **å¼€å‘ç¯å¢ƒè¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒ**
5. **test-url-generation.html çš„æµ‹è¯•ç»“æœ**

---

**ä¿®å¤ç‰ˆæœ¬**: v1.1.0  
**ä¿®å¤æ—¥æœŸ**: 2025å¹´1æœˆ  
**çŠ¶æ€**: âœ… å·²ä¿®å¤ï¼Œç­‰å¾…æµ‹è¯•éªŒè¯

